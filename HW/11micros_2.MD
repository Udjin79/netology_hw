# Домашнее задание к занятию "`Микросервисы: принципы`" - `Исаенков Евгений`

## Задание

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

---

## Ответ

**Задача 1: API Gateway**

Для анализа были выбраны следующие бесплатные программные продукты, которые могут быть использованы для реализации API Gateway:

| Критерий                                    | Nginx              | Kong Gateway (Community) | KrakenD             |
|---------------------------------------------|--------------------|--------------------------|---------------------|
| **Настройка маршрутизации через конфигурацию**           | Да                 | Да                       | Да                  |
| **Поддержка аутентификации**  | Да (через модули)  | Да (через плагины)       | Да                  |
| **HTTPS**                        | Да                 | Да                       | Да                  |
| **Поддержка плагинов**             | Ограничена         | Да                       | Ограничена          |
| **Поддержка масштабирования**               | Да                 | Да                       | Да                  |
| **Простота эксплуатации**                   | Средняя            | Средняя                  | Высокая             |
| **Стоимость**                               | Бесплатно (Open Source) | Бесплатно (Community Edition) | Бесплатно (Open Source) |


**Чем обоснован выбор решения**

С учётом бесплатных возможностей, **Kong Gateway (Community Edition)** является оптимальным выбором. Kong предлагает богатую функциональность с поддержкой аутентификации, маршрутизации и терминации HTTPS, а также масштабируемость и расширяемость через плагины.

- Все основные функции (маршрутизация, аутентификация, HTTPS) доступны в бесплатной версии.
- Расширяемость через плагины позволяет настроить Kong под различные требования.
- Хорошо масштабируется и активно поддерживается сообществом.

Почему не выбраны другое решение, такое как Nginx:

Nginx можно использовать как API Gateway, так как он поддерживает базовую маршрутизацию, аутентификацию и терминацию HTTPS. Однако, есть причины, почему Kong или другие специализированные API Gateway решения предпочтительнее:

- Nginx изначально создавался как веб-сервер и реверс-прокси, и его функциональность в качестве API Gateway ограничена по сравнению с решениями, специально разработанными для API, такими как Kong или KrakenD. В Nginx нужно будет дополнительно настраивать модули или использовать конфигурационные трюки для поддержки аутентификации и расширенных функций маршрутизации.

- Специализированные API Gateway, как Kong, предлагают плагины и расширения для многих задач, таких как аутентификация, авторизация, логирование и управление трафиком, что позволяет гибко добавлять новые функции без изменения основной конфигурации. У Nginx же расширяемость через плагины ограничена.

- Kong и другие API Gateways предоставляют более удобные инструменты для управления, масштабирования и мониторинга API, что важно при работе с микросервисной архитектурой, где API являются основным способом взаимодействия между сервисами.

- Kong и другие решения API Gateway имеют интерфейсы управления, которые облегчают работу с API, настройку аутентификации и отслеживание запросов.

Суммируя все вышесказанное: если основная задача это создание полноценного API Gateway с возможностью масштабируемого управления API и расширенными функциями, то Kong, KrakenD или аналогичные решения лучше подходят для этих целей. Nginx остаётся отличным вариантом, если требуется только базовая маршрутизация и SSL-терминация.

---

**Задача 2: Брокер сообщений**

Для анализа были выбраны следующие бесплатные программные продукты, которые могут быть использованы для реализации брокера сообщений:

| Критерий                                    | RabbitMQ           | Apache Kafka       | ActiveMQ         |
|---------------------------------------------|--------------------|--------------------|------------------|
| **Поддержка кластеризации**                 | Да                 | Да                 | Да               |
| **Хранение сообщений на диске**             | Да                 | Да                 | Да               |
| **Скорость работы**                 | Высокая            | Очень высокая      | Средняя          |
| **Поддержка различных форматов сообщений**  | Да                 | Да                 | Да               |
| **Разделение прав доступа**                 | Да                 | Да (ACL)           | Да               |
| **Простота эксплуатации**                   | Средняя            | Сложная            | Средняя          |

**Чем обоснован выбор решения**

**RabbitMQ** стал оптимальным выбором благодаря его стабильности и широким возможностям для организации взаимодействия между микросервисами. Важной особенностью является поддержка работы с различными форматами сообщений, обеспечивая гибкость интеграции сервисов с разными требованиями. Продукт широко используется, надёжен и поддерживает кластеризацию, что способствует высокой отказоустойчивости системы и снижению рисков потери данных. Хранение сообщений на диске гарантирует их сохранность в процессе передачи, что особенно важно для критичных операций. 
RabbitMQ также обладает гибкими настройками прав доступа, что позволяет разграничить доступ к различным потокам сообщений и обеспечить безопасность данных. 

Кроме обширного набора функционала данный продукт имеет активное сообщество и обширную документацию. 

Всё это делает RabbitMQ надёжным решением для микросервисной архитектуры с высокими требованиями к производительности и безопасности.